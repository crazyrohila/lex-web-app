"use strict";var jq,chatbot={rootElementId:window.chatbot_identifier?chatbot_identifier:"chatbot-widget",initializer:window.initializer?initializer:null,widget:!window.fullPage,botName:window.botName?botName:null,botAlias:window.botAlias?botAlias:"$LATEST",region:window.awsRegion?awsRegion:"us-east-1",poolId:window.awsCognitoPoolId?awsCognitoPoolId:null,lexruntime:null,lexUserId:"lex-web-"+Date.now(),sessionAttributes:{},aws_sdk_path:"https://sdk.amazonaws.com/js/aws-sdk-2.340.0.min.js"};function elementWithRootContext(t){return"#"+chatbot.rootElementId+" "+t}function getConversationNode(){return document.querySelector(elementWithRootContext("#conversation"))}function getWidgetContainer(t,e){var i=document.createElement("div");if(i.className="main-container",i.setAttribute("id","main-container"),i.innerHTML=pageTemplate(e),e){var o=t.target.getBoundingClientRect(),a=t.clientX-o.left+"px";t.clientY,o.top,o.height;i.style="position: fixed; right: "+a+";"}return i}function pageTemplate(t){return'\n    <div class="chatbot-header">\n      <div class="logo">\n        Lex Web-App\n      </div>\n      <div class="powered-logo">\n        <img src="https://d1.awsstatic.com/logos/aws/PB_AWS_logo_RGB.jpg">\n      </div>\n      '+(t?'<div class="widget-actions">\n        <span class="widget-actions__toggle" onclick="show_hide()">__</span>\n        <span class="widget-actions__close" onclick="close_widget()">X</i></span>\n        </div>':"")+'\n    </div>\n    <div id="conversation"></div>\n    <form id="chatform" class="chatform" onsubmit="return pushMessageToLex();">\n      <input type="text" id="chatform-input" class="chatform-input" size="80" value="" placeholder="type your query">\n      <button type="submit" class="btn-submit" value="submit">Submit</button>\n    </form>\n  '}function createChatRow(t){var e=document.createElement("div"),i="request"==t?"left":"right";return e.className="chat-row chat-row--"+t+" chat-row-"+i,e}function buildRequestRow(t){var e=createChatRow("request");return e.innerHTML='\n    <div class="bot-icon"></div>\n    <div class="message message--request">'+t+"</div>\n  ",e}function buildResponseRow(t){var e=createChatRow("response");return e.innerHTML='\n    <div class="bot-icon"><img src="assets/botIcon.png"></div>\n    <div class="message message--response">'+t+"</div>\n  ",e}function addToConversation(t){var e=getConversationNode();e.appendChild(t),e.scrollTop=e.scrollHeight}function showRequest(t){addToConversation(buildRequestRow(t))}function showError(t){console.log(t);var e=document.createElement("p");e.className="message--error",e.appendChild(document.createTextNode(t)),addToConversation(e)}function showResponse(t){addToConversation(buildResponseRow(t.message?t.message:""));try{t.responseCard&&t.responseCard.genericAttachments&&addToConversation(buildResponseRow(generateCardsItem(t.responseCard.genericAttachments)))}catch(t){console.log(t)}}function generateCardsItem(t){var e='<div class="cards">',i=null;return t.forEach(function(t){t.buttons&&(i=generatePickerItem(t.buttons)),e+='\n      <div class="card-item">\n        '+(t.attachmentLinkUrl?'<a class="card-link" href="'+t.attachmentLinkUrl+'">':"")+"\n          "+(t.imageUrl?'<img src="'+t.imageUrl+'">':"")+"\n          "+(t.title?'<h3 class="card-title">'+t.title+"</h3>":"")+"\n          "+(t.subTitle?'<h4 class="card-sub-title">'+t.subTitle+"</h4>":"")+"\n          "+(t.buttons?i:"")+"\n        "+(t.attachmentLinkUrl?"</a>":"")+"\n      </div>\n    "}),e+="</div>"}function generatePickerItem(t){var e='<div class="buttons">';return t.forEach(function(t){e+='\n      <span class="button" onclick="pushMessageToLex(\''+t.value+'\')" data-value="'+t.value+'">'+t.text+"</span>\n    "}),e+="</div>"}function pushMessageToLex(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],i=document.getElementById("chatform-input");t||(t=i.value);var o={botAlias:chatbot.botAlias,botName:chatbot.botName,inputText:t,userId:chatbot.lexUserId,sessionAttributes:chatbot.sessionAttributes},a={error:showError,success:showResponse};return e||showRequest(t),postToLex(o,a,i),!1}function postToLex(t,i,o){o&&(o.value="...",o.setAttribute("readonly",!0),o.classList.add("disabled")),chatbot.lexruntime.postText(t,function(t,e){t&&i.error("Error:  "+t.message+" (see console for details)"),e&&(chatbot.sessionAttributes=e.sessionAttributes,i.success(e)),o&&(o.value="",o.removeAttribute("readonly"),o.classList.remove("disabled"))})}function show_hide(){var t=document.getElementById("main-container");"none"===t.style.display?t.style.display="block":t.style.display="none"}function close_widget(){var t=document.getElementById("main-container");return document.getElementById("view_chat").style.removeProperty("display"),t.parentNode.removeChild(t),!1}function launchWidget(t,e){var i=document.getElementById(chatbot.rootElementId),o=(i.getAttribute("data-username"),document.querySelectorAll(elementWithRootContext(".main-container")));if(o&&o.length)show_hide();else{o=getWidgetContainer(t,e),i.appendChild(o);if(addToConversation(buildResponseRow("Hi, I am your virtual assistant.")),chatbot.initializer){pushMessageToLex(chatbot.initializer,!0)}}}function chatinit(){if(chatbot.botName)if(chatbot.poolId){var t=document.getElementById(chatbot.rootElementId);t||((t=document.createElement("div")).id=chatbot.rootElementId,t.setAttribute("data-username","there!"),document.body.appendChild(t)),loadStyles(),includejQuery(function(){loadScript(chatbot.aws_sdk_path,function(){AWS.config.region=chatbot.region,AWS.config.credentials=new AWS.CognitoIdentityCredentials({IdentityPoolId:chatbot.poolId}),chatbot.lexruntime=new AWS.LexRuntime}),chatbot.widget?(t.classList+="window-widget",t.innerHTML+='\n        <div class="view_chat" id="view_chat" onclick="launchWidget(event, true)" aria-hidden="true">\n          <i class="">+</i>\n        </div>\n      '):(launchWidget(null,!1),t.classList+="window-page")})}else console.log("Please provide cognito pool id for Lex");else console.log("Please provide lex botName")}function loadStyles(){var t=document.createElement("style");t.innerText='[id^="chatbot-widget"] *,[id^="chatbot-widget"] *:before,[id^="chatbot-widget"] *:after{box-sizing:border-box}[id^="chatbot-widget"] img{width:100%;height:auto;vertical-align:baseline}[id^="chatbot-widget"] .chatbot-header{position:relative;display:flex;justify-content:space-between;padding:30px 10px 10px;border-bottom:3px solid}[id^="chatbot-widget"] .logo{font-size:24px}[id^="chatbot-widget"] .chatbot-header img{max-width:100px;height:auto}[id^="chatbot-widget"] .widget-actions{position:absolute;right:0;top:0}[id^="chatbot-widget"] .widget-actions span{display:inline-block;padding:0 4px;color:#fff;font-size:20px;cursor:pointer}[id^="chatbot-widget"] .widget-actions__toggle{background:#5217ca}[id^="chatbot-widget"] .widget-actions__close{background:#f77}[id^="chatbot-widget"].window-widget .main-container{z-index:10;font-size:12px;min-height:350px;width:480px;bottom:86px;border:1px solid #5217ca}[id^="chatbot-widget"] #conversation{position:relative;overflow-y:auto;min-height:inherit;width:auto;padding-top:20px}[id^="chatbot-widget"].window-widget #conversation{height:380px}[id^="chatbot-widget"].window-page #conversation{height:75vh}[id^="chatbot-widget"] .chat-row{clear:both;overflow:hidden;padding:0 10px}[id^="chatbot-widget"] .bot-icon img{max-width:45px}[id^="chatbot-widget"] .message{max-width:65%;min-width:50%;border:0;margin-bottom:12px;margin-top:6px;border-radius:10px;box-shadow:0 0 10px #ccc;padding:10px}[id^="chatbot-widget"] .chat-row-left .bot-icon{margin-right:10px;float:left}[id^="chatbot-widget"] .chat-row-right .bot-icon{margin-left:10px;float:right}[id^="chatbot-widget"] .chat-row-left .message{float:left;text-align:left;border-top-left-radius:0}[id^="chatbot-widget"] .chat-row-right .message{float:right;text-align:right;border-top-right-radius:0}[id^="chatbot-widget"] .message--error{margin:4px;padding:4px 10px 4px 10px;border-radius:4px;text-align:right;min-width:50%;max-width:85%;float:right;background-color:#f77}[id^="chatbot-widget"] .chatform{position:relative;height:35px;margin:0}[id^="chatbot-widget"] .chatform-input{padding:8px 10px;font-size:14px;width:100%;display:inherit;border:1px solid #5217ca}[id^="chatbot-widget"] .chatform-input.disabled{cursor:not-allowed;background:#ccc}[id^="chatbot-widget"] .chatform-input::placeholder{color:#ccc;font-style:italic}[id^="chatbot-widget"] .chatform .btn-submit{position:absolute;top:0;right:0;height:inherit;background:#5217ca;color:#fff;border:0}[id^="chatbot-widget"] .button{display:inline-block;padding:5px 8px;background:#5217ca;margin:5px;color:#fff;cursor:pointer}[id^="chatbot-widget"] .cards{overflow:scroll;display:flex;flex-wrap:nowrap;justify-content:flex-start}[id^="chatbot-widget"] .card-item{display:flex;flex-direction:column;justify-content:stretch;align-items:center;max-width:200px;overflow:hidden;border:1px solid #ccc;border-radius:10px;margin:10px;cursor:pointer}[id^="chatbot-widget"] .card-item img{border-bottom:1px solid}[id^="chatbot-widget"] .card-item .card-title,[id^="chatbot-widget"] .card-item .card-sub-title{align-self:flex-start;margin:0;padding:0 5px}[id^="chatbot-widget"] .card-link{margin:0;color:#5217ca}[id^="chatbot-widget"] .buttons{width:100%;display:flex;align-items:center;flex-wrap:wrap;justify-content:center;padding:5px}[id^="chatbot-widget"] .view_chat{position:fixed;bottom:35px;right:35px;width:40px;height:40px;background:#5217ca;border-radius:50%;color:#fff;font-size:36px;line-height:100%;text-align:center;cursor:pointer}[id^="chatbot-widget"] .audio-control{cursor:pointer;background-color:#fff;box-shadow:0 0 8px #5217ca;border-radius:100px;height:100px;margin:20px auto;width:100px;display:flex;margin-bottom:0}[id^="chatbot-widget"] .audio-control:hover,[id^="chatbot-widget"] .audio-control--active{box-shadow:0 0 8px #5217ca}[id^="chatbot-widget"] .audio-control i{margin:auto}[id^="chatbot-widget"] .voice--message--status{text-align:center;padding:5px;margin-top:0}[id^="chatbot-widget"] .lex-voice--close{float:right;padding:12px}',document.head.appendChild(t)}function loadScript(t,e){var i=document.createElement("script");i.readyState?i.onreadystatechange=function(){"loaded"!==i.readyState&&"complete"!==i.readyState||(i.onreadystatechange=null,e())}:i.onload=function(){e()},i.src=t,document.getElementsByTagName("head")[0].appendChild(i)}function includejQuery(t){if(window.jQuery)jq=jQuery,t();else{var e=document.createElement("script");e.onload=function(){jQuery.noConflict(),jq=jQuery,t()},e.src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js",document.getElementsByTagName("head")[0].appendChild(e)}}chatinit();